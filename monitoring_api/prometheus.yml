  global:
    scrape_interval: 15s
    evaluation_interval: 15s
    external_labels:
      cluster: 'central'
      environment: 'production'

  rule_files:
    # - "rules.yml"

  scrape_configs:
    # Prometheus
    - job_name: 'prometheus'
      static_configs:
        - targets: ['localhost:9090']
      metrics_path: '/prometheus/metrics'

    # Métricas del app node
    - job_name: 'app-node'
      static_configs:
        - targets: ['10.20.12.169:9100']
          labels:
            nombre: 'APP'
      scrape_interval: 15s

    # Métricas de los headnodes
    - job_name: 'headnodes'
      static_configs:
        - targets: ['192.168.203.1:9100']
          labels:
            nombre: 'Headnode-linux'
        - targets: ['192.168.204.1:9100']
          labels:
            nombre: 'Headnode-openstack'
      scrape_interval: 15s

    # Métricas de contenedores Docker
    - job_name: 'docker_network'
      static_configs:
        - targets: ['monitoring_docker_network:8080']
      scrape_interval: 15s

    # Blackbox Exporter - Verificación de conectividad a los clusters
    - job_name: 'blackbox-headnodes'
      metrics_path: /probe
      params:
        module: [icmp]
      static_configs:
        - targets:
            - 192.168.203.1  # Headnode-linux
          labels:
            cluster: 'linux'
            nombre: 'Headnode-Linux'
        - targets:
            - 192.168.204.1  # Headnode-openstack
          labels:
            cluster: 'openstack'
            nombre: 'Headnode-OpenStack'
      relabel_configs:
        - source_labels: [__address__]
          target_label: __param_target
        - source_labels: [__param_target]
          target_label: instance
        - target_label: __address__
          replacement: 10.20.12.169:9115  # Dirección del blackbox exporter
      scrape_interval: 15s